import os
import json
import pygsheets

class CfgHandler:
    def __init__(self, name):
        self.filename = name + ".json"
        # Create file if it does not exist
        file = open(self.filename, 'a', encoding='utf-8')
        file.close()

        file = open(self.filename, 'r+', encoding='utf-8')
        if file.read() == "":
            json.dump({}, file, indent=4)
        file.close()

    def update(self, username, password, id64, shared, identity):
        file = open(self.filename, 'r', encoding='utf-8')
        data = json.load(file)
        file.close()
        data[username] = {'Password': password,
                          "ID64": id64,
                          "Shared secret": shared,
                          "Identity secret": identity}
        file = open(self.filename, 'w', encoding='utf-8')
        json.dump(data, file, indent=4)
        file.close()

    def read(self):
        file = open(self.filename, 'r', encoding='utf-8')
        data = json.load(file)
        file.close()
        return data